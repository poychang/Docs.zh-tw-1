---
title: "MageUI.exe (圖形用戶端、資訊清單產生和編輯工具)"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Manifest Generation and Editing tool
- MageUI.exe
ms.assetid: f9e130a6-8117-49c4-839c-c988f641dc14
caps.latest.revision: "38"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: ec4ac8d89d2d3a7d0dce11e5057db80190e7b963
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/19/2018
---
# <a name="mageuiexe-manifest-generation-and-editing-tool-graphical-client"></a>MageUI.exe (圖形用戶端、資訊清單產生和編輯工具)
MageUI.exe 與命令列工具 Mage.exe 支援相同的功能，不過前者會採用 Windows 使用者介面 (UI)。 您可以利用此工具建立、編輯和簽章部署與應用程式資訊清單。 使用 MageUI.exe 建立的新資訊清單是以 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 為目標。 若要以舊版 .NET Framework 為目標，則應該使用舊版 MageUI.exe。 在資訊清單中加入或移除組件或重新簽署現有資訊清單時，MageUI.exe 並不會更新資訊清單，使其以 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 為目標。 如需詳細資訊，請參閱 [Mage.exe (資訊清單產生和編輯工具)](../../../docs/framework/tools/mage-exe-manifest-generation-and-editing-tool.md)。  
  
 此工具會自動與 Visual Studio 一起安裝。 若要執行此工具，請使用 [開發人員命令提示字元] (或 Windows 7 中的 [Visual Studio 命令提示字元])。 如需詳細資訊，請參閱[命令提示字元](../../../docs/framework/tools/developer-command-prompt-for-vs.md)。  
  
 [!INCLUDE[vs_dev10_long](../../../includes/vs-dev10-long-md.md)] 安裝程式有兩個版本的 Mage.exe 和 MageUI.exe 做為隨附元件。 若要查看版本資訊，請執行 MageUI.exe，並依序選取 [ **說明**] 和 [ **關於**]。 本文件說明 4.0.x.x 版本的 Mage.exe 和 MageUI.exe。  
  
> [!NOTE]
>  如果 MageUI.exe 要儲存的應用程式資訊清單已使用 MageUI.exe 透過憑證簽署，則不支援 [compatibleFrameworks](/visualstudio/deployment/compatibleframeworks-element-clickonce-deployment) 項目。 您必須改用 [Mage.exe](../../../docs/framework/tools/mage-exe-manifest-generation-and-editing-tool.md)。  
  
## <a name="uielement-list"></a>UIElement 清單  
 下表列出可用的功能表和工具列項目。  
  
|命令|功能表|快速鍵|描述|  
|-------------|----------|--------------|-----------------|  
|**應用程式資訊清單**|**檔案、新增**||建立新的應用程式資訊清單。|  
|**部署資訊清單**|**檔案、新增**||建立新的部署資訊清單。|  
|**開啟**|**檔案**|CTRL+O|開啟現有的部署資訊清單、應用程式資訊清單或信任授權以進行編輯。|  
|**關閉**|**檔案**|CTRL+F4|關閉開啟的檔案。<br /><br /> 如果您在檔案關閉之前進行修改，MageUI.exe 會提示您使用公開金鑰、金鑰組或預存憑證重新簽章此檔案。|  
|**儲存**|**檔案**|CTRL+S|將目前使用者輸入焦點所在的文件儲存至磁碟中。|  
|**另存新檔**|**檔案**||將檔案儲存至磁碟，並且讓您提供新的檔案名稱和 (或) 位置。|  
|**全部儲存**|**檔案**||儲存對 MageUI.exe 中目前開啟的所有檔案所進行的變更。|  
|**偏好設定**|**檔案**||開啟 [偏好設定] 對話方塊。 如需詳細資訊，請參閱下一節。|  
|**結束**|**檔案**|ALT+F4|結束 MageUI.exe。|  
|**剪下**|**編輯**|CTRL+X|從應用程式中移除目前選取的文字，然後移至系統 [剪貼簿]。|  
|**複製**|**編輯**|CTRL+C|將目前選取的文字複製到系統 [剪貼簿]。|  
|**貼上**|**編輯**|CTRL+V|將文字從系統 [剪貼簿] 貼到目前現用的文字項目上。|  
|**刪除**|**編輯**||刪除清單中目前選取的項目，例如 [部署資訊清單] 索引標籤上的信任授權。|  
|**全部關閉**|**視窗**||關閉 MageUI.exe 中目前開啟的所有檔案。 如果其中一個或多個檔案需要儲存，MageUI.exe 會提示您將它們儲存。 MageUI.exe 也會提示您為每個未簽署或變更過的檔案選取簽署金鑰。|  
|**關於**|**說明**||顯示有關 MageUI.exe 的版本和著作權資訊。|  
  
## <a name="preferences-dialog-box"></a>偏好設定對話方塊  
 [偏好設定] 對話方塊包含下列項目。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**於儲存時簽署**|每當您儲存修改內容時，提示您簽署檔案。|  
|**使用預設簽署憑證**|使用 [憑證檔] 文字方塊中輸入的金鑰簽署所有檔案。 這樣一來就不會顯示通常在您儲存檔案而且已選取 [於儲存時簽署] 的情況下會出現的簽署提示。 請使用 [憑證檔] 文字方塊旁的省略符號 (**…**) 按鈕選取金鑰檔。|  
|摘要演算法|指定產生相依性摘要的演算法。 值必須是 "sha256RSA" 或 "sha1RSA"。 預設為使用 SHA1。 兩種都會在應用程式和部署資訊清單中使用。 如果使用者在儲存資訊清單時提供憑證，請使用憑證中的演算法產生相依性摘要。|  
  
## <a name="signing-options-dialog-box"></a>簽署選項對話方塊  
 當您初次儲存資訊清單或信任授權，或是變更資訊清單或信任授權時，[簽署選項] 對話方塊就會出現。 只有在 [偏好設定] 對話方塊中的 [於儲存時簽署] 選項為選取狀態時，它才會出現。 若您簽署的資訊清單會在 [時間戳記 URI] 文字方塊中指定值，則必須連線到網際網路。  
  
 這個對話方塊包含下列項目。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**用憑證檔簽署**|使用儲存於檔案系統上的數位憑證簽署資訊清單。|  
|**檔案**|提供一個區域，以便輸入代表憑證的 .pfx 檔路徑。|  
|**...**|開啟 [選擇檔案] 對話方塊，選取現有的 .pfx 檔。|  
|**新增**|產生新的 .pfx，這個檔案無法透過憑證授權單位 (CA) 進行驗證。 如需用於簽署 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 部署所使用之憑證類型的詳細資訊，請參閱[受信任的應用程式部署概觀](/visualstudio/deployment/trusted-application-deployment-overview)。|  
|**密碼**|提供輸入密碼的區域，此密碼會在使用此憑證簽署時使用。 如果不適用，可以保持空白。|  
|**用儲存的憑證簽署**|以可選取清單的形式，顯示儲存在電腦憑證存放區內的數位憑證。|  
|**時間戳記 URI**|顯示數位時間戳記服務的統一資源定位器 (URI)。 在資訊清單加上時間戳記之後，若數位憑證在您部署應用程式的下一個版本之前到期，就無須重新簽署資訊清單。 如需詳細資訊，請參閱 [Windows 根憑證計劃成員](http://go.microsoft.com/fwlink/?LinkId=159000)和 [ClickOnce 和 Authenticode](/visualstudio/deployment/clickonce-and-authenticode)。|  
|**不簽署**|可讓您儲存資訊清單，而不需要從數位憑證加入簽章。|  
  
## <a name="tab-and-panel-descriptions"></a>索引標籤和面板描述  
 當您使用 MageUI.exe 開啟文件時，文件會出現在自己的索引標籤頁內。 每個索引標籤都包含一組屬性面板。 面板中包含一組文件資料的子集。  
  
### <a name="application-manifest-tab"></a>應用程式資訊清單索引標籤  
 [應用程式資訊清單] 索引標籤會顯示應用程式資訊清單的內容。 應用程式資訊清單描述使用部署時，所包含的所有檔案和用戶端上執行應用程式所需的權限。  
  
 [應用程式資訊清單] 索引標籤包含下列索引標籤。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**名稱**|指定此部署相關的識別資訊。|  
|**描述**|指定發行者、 產品和支援資訊。|  
|**應用程式選項**|指定這是否為瀏覽器應用程式，及此資訊清單是否為信任資訊的來源。|  
|**檔案**|指定所有構成這個部署的檔案。|  
|**必要的使用權限**|指定要在用戶端上執行的應用程式所需的最低權限集合。|  
  
### <a name="name-tab"></a>名稱索引標籤  
 當您第一次建立或開啟應用程式資訊清單時，[名稱] 索引標籤會顯示。 它會唯一識別部署，並選擇性地指定有效的目標平台。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**名稱**|必要。 應用程式資訊清單的名稱。 通常與檔案名稱相同。|  
|**版本**|必要。 在表單中部署的版本號碼 N.N.N.N。 只需要第一個主要組建編號。 例如，應用程式版本 1.0，有效的值會包含 `1`、`1.0`、`1.0.0` 和 `1.0.0.0`。|  
|**處理器**|選擇性。 可以執行此部署的電腦架構。 預設值是 `msil`，或 Microsoft 中繼語言，也就是所有的 Managed 組件的預設格式。 如果您要針對應用程式中的特定架構預先編譯組件，請變更此欄位。 如需有關預先編譯的詳細資訊，請參閱 [Ngen.exe (原生映像產生器)](../../../docs/framework/tools/ngen-exe-native-image-generator.md)。|  
|**文化特性**|選擇性。 此應用程式執行的兩部分 ISO 國家及區域代碼。 預設為 `neutral`。|  
|**公開金鑰語彙基元**|選擇項。 已簽署此應用程式資訊清單的公開金鑰。 如果這是新的或不帶正負號的資訊清單，此欄位會顯示為 `Unsigned`。|  
  
### <a name="description-tab"></a>描述索引標籤  
 部署資訊清單內通常會提供此資訊。 當選取 [應用程式選項] 索引標籤上的 [使用應用程式資訊清單信任資訊] 核取方塊時，才能修改這些欄位。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**發行者**|負責應用程式之人員或組織的名稱。 使用此值做為 [開始] 功能表資料夾名稱。|  
|**產品**|完整的產品名稱。 如果您選取部署資訊清單中 [部署選項] 索引標籤上之 [應用程式類型] 項目的 [本機安裝]，此應用程式的 [開始] 功能表連結和 [新增或移除程式] 中顯示的名稱即為產品的名稱。|  
|**支援位置**|客戶可以從 URL 取得應用程式說明及支援。|  
  
### <a name="application-options-tab"></a>應用程式選項索引標籤  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**Windows Presentation Foundation 瀏覽器應用程式**|指定是否是會在瀏覽器中以 XAML 瀏覽器應用程式 (XBAP) 執行的 WPF 應用程式。|  
|**使用應用程式資訊清單的信任資訊**|指定此資訊清單是否包含信任資訊。|  
  
### <a name="files-tab"></a>檔案索引標籤  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**應用程式目錄**|應用程式檔案的所在目錄。 使用省略符號 ([...]) 按鈕來選取目錄。|  
|**填入**|將應用程式目錄和子目錄中的所有檔案新增到應用程式資訊清單。 如果 MageUI.exe 在目錄中發現單一可執行檔，它會自動將此標示為進入點，也就是用戶端啟動 ClickOnce 應用程式時第一個執行的檔案。|  
|**應用程式檔案**|列出所有應用程式中的檔案。 每個檔案有三個可編輯的屬性，將於下列討論。|  
|**檔案類型**|檔案類型可以是四個值之一：<br /><br /> -   無。<br />-   進入點。 應用程式的主要可執行檔。 只有一個可執行檔可以標示為進入點。<br />-   資料檔案。 提供資料給應用程式的檔案，例如 XML 檔案。<br />-   圖示檔。 應用程式圖示，例如會出現在桌面或應用程式視窗的角落。|  
|**Optional**|標示為選擇性的檔案不會在初始安裝或更新時下載，但是可能會在執行階段使用系統部署隨選 API 下載。 如需詳細資訊，請參閱[逐步解說：下載組件隨選與 ClickOnce 部署應用程式開發介面使用設計工具](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer)。|  
|**群組**|一組選擇性檔案的標籤。 您可以將群組標籤套用至一組檔案，並使用隨選應用程式開發介面，透過單一應用程式開發介面呼叫來下載批次檔案。|  
  
### <a name="permissions-required-tab"></a>所需權限索引標籤  
 使用 [所需權限] 索引標籤，如果您要授與您的應用程式到本機電腦比預設更多的存取權。 如需詳細資訊，請參閱[保護 ClickOnce 應用程式](/visualstudio/deployment/securing-clickonce-applications)。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**使用權限集合類型**|指定要在用戶端上執行的應用程式所需的最低權限集合。 如需這些權限集合的描述和其所會要求的權限，請參閱 [NIB：具名使用權限集合](http://msdn.microsoft.com/library/08250d67-c99d-4ab0-8d2b-b0e12019f6e3)。|  
|**詳細資料**|建立應用程式資訊清單的 XML 來表示權限設定。 除非您有充分的了解應用程式資訊清單 XML 格式，否則您應該手動編輯此 XML。 如需詳細資訊，請參閱 [ClickOnce 應用程式資訊清單](/visualstudio/deployment/clickonce-application-manifest)。|  
  
### <a name="deployment-manifest-tab"></a>部署資訊清單索引標籤  
 [部署資訊清單] 索引標籤包含下列索引標籤。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**名稱**|指定此部署相關的識別資訊。|  
|**描述**|指定發行者、 產品和支援資訊。|  
|**部署選項**|指定其他部署相關的資訊，例如應用程式類型和開始位置。|  
|**更新選項**|指定多久 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應該檢查應用程式更新。|  
|**應用程式參考**|指定此部署的應用程式資訊清單。|  
  
### <a name="name-tab"></a>名稱索引標籤  
 當您第一次建立或開啟部署資訊清單時，[名稱] 索引標籤會顯示。 它會唯一識別部署，並選擇性地指定有效的目標平台。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**名稱**|必要。 部署資訊清單的名稱。 通常與檔案名稱相同。|  
|**版本**|必要。 在表單中部署的版本號碼 N.N.N.N。 只需要第一個主要組建編號。 例如，應用程式版本 1.0，有效的值會包含 `1`、`1.0`、`1.0.0` 和 `1.0.0.0`。|  
|**處理器**|選擇性。 可以執行此部署的電腦架構。 預設值是 `msil`，或 Microsoft 中繼語言，是所有的 Managed 組件的預設格式。 如果您要針對應用程式中的特定架構編譯組件，請變更此欄位。|  
|**文化特性**|選擇性。 此應用程式執行的兩部分 ISO 國家/區域代碼。 預設為 `neutral`。|  
|**公開金鑰語彙基元**|選擇性。 已簽署此部屬資訊清單的公開金鑰。 如果這是新的或不帶正負號的資訊清單，此欄位會顯示為 `Unsigned`。|  
  
### <a name="description-tab"></a>描述索引標籤  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**發行者**|必要。 負責應用程式之人員或組織的名稱。 使用此值做為 [開始] 功能表資料夾名稱。|  
|**產品**|必要。 完整的產品名稱。 如果您選取 [部署選項] 索引標籤上之 [應用程式類型] 項目的 [本機安裝]，此應用程式的 [開始] 功能表連結和 [新增或移除程式] 中顯示的名稱即為產品的名稱。|  
|**支援位置**|選擇性。 客戶可以從 URL 取得應用程式說明及支援。|  
  
### <a name="deployment-options-tab"></a>部署選項索引標籤  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**應用程式類型**|選擇性。 指定是否將這個應用程式本身安裝至用戶端電腦 ([本機安裝])，在線上執行 ([僅限線上])，或者在瀏覽器中執行的 WPF 應用程式 (WPF 瀏覽器應用程式 )。 預設值是 [本機安裝]。|  
|**開始位置**|選擇性。 應用程式應該實際從 URL 中啟動。 從 CD 部署應用程式時很有用，其應該從 Web 更新本身。|  
|**包含資訊清單中的開始位置 (ProviderURL)**|選擇性。 指定 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 會檢查應用程式更新的 URL。|  
|**在安裝後自動執行的應用程式**|必要。 指定 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應用程式應該在從 URL 初始安裝之後，立刻執行。 這個核取方塊預設為已選取。|  
|**允許 URL 參數傳遞至應用程式**|必要。 允許參數資料傳輸到 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應用程式，透過查詢字串附加至部署資訊清單的 URL。 這個核取方塊預設為已清除。|  
|**使用 .deploy 副檔名**|必要。 選取時，應用程式資訊清單中的所有檔案必須都有 .deploy 副檔名。 這個核取方塊預設為已清除。|  
  
### <a name="update-options-tab"></a>更新選項索引標籤  
 [更新選項] 索引標籤只會包含此處提到的選項 (當 [應用程式類型] 上的選取方塊 [名稱] 索引標籤設定為 [本機安裝])。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**此應用程式應該檢查更新**|指定是否 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應該檢查應用程式更新。 如果未選取此核取方塊，應用程式將不會檢查更新，除非您使用 <xref:System.Deployment.Application> 命名空間中的應用程式開發介面，以程式設計方式更新它。|  
|**此應用程式應該檢查更新**|提供兩個更新檢查選項：<br /><br /> -   [應用程式啟動之前]。 執行應用程式之前，先執行更新檢查。<br />-   [應用程式啟動後]。 應用程式的主要表單一完成初始化便會開始檢查更新，並將在下一次應用程式啟動之後執行。|  
|**更新檢查頻率**|決定多久 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應該檢查更新：<br /><br /> -   [每次執行應用程式時檢查]。 每次使用者開啟應用程式，[!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 將會執行更新檢查。<br />-   **檢查每個**：選取檢查更新前，必須經過多久時間間隔和單位 (小時、天或週)。|  
|**指定此應用程式的最小必要的版本**|選擇性。 指定您應用程式的特定版本是必要的安裝，防止您的使用者使用較舊的版本。|  
|**版本**|若選取 [指定此應用程式的最小必要的版本] 核取方塊，則為必要項。 提供的版本號碼的格式必須是 N.N.N.N。 只需要第一個主要組建編號。 例如，應用程式版本 1.0，有效的值會包含 `1`、`1.0`、`1.0.0` 和 `1.0.0.0`。|  
  
### <a name="application-reference-tab"></a>應用程式參考索引標籤  
 [應用程式參考] 索引標籤包含本主題稍早所述與 [名稱] 索引標籤相同的欄位。 唯一例外的是下列欄位。  
  
|UI 項目|描述|  
|----------------|-----------------|  
|**選取資訊清單**|可讓您選擇應用程式資訊清單。 當您選擇應用程式資訊清單時，將填入此頁面上的所有其他欄位。|  
  
## <a name="see-also"></a>請參閱  
 [ClickOnce 安全性和部署](/visualstudio/deployment/clickonce-security-and-deployment)  
 [逐步解說：手動部署 ClickOnce 應用程式](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application)  
 [Mage.exe (資訊清單產生和編輯工具)](../../../docs/framework/tools/mage-exe-manifest-generation-and-editing-tool.md)
